// src/body.tsx
import { forwardRef } from "react";
import { Scripts, ScrollRestoration } from "@remix-run/react";
import { jsx, jsxs } from "react/jsx-runtime";
var Body = forwardRef(
  ({ children, ...props }, ref) => /* @__PURE__ */ jsxs("body", { ...props, ref, children: [
    children,
    /* @__PURE__ */ jsx(Scripts, {}),
    /* @__PURE__ */ jsx(ScrollRestoration, {})
  ] })
);
Body.displayName = "Body";

// src/link.tsx
import { Link as BaseLink } from "@webstudio-is/sdk-components-react";

// src/shared/remix-link.tsx
import { forwardRef as forwardRef2, useContext } from "react";
import { NavLink as RemixLink } from "@remix-run/react";
import { ReactSdkContext } from "@webstudio-is/react-sdk";
import { jsx as jsx2 } from "react/jsx-runtime";
var wrapLinkComponent = (BaseLink3) => {
  const Component = forwardRef2((props, ref) => {
    const { pagesPaths } = useContext(ReactSdkContext);
    const href = props.href;
    if (href !== void 0) {
      const url = new URL(href, "https://any-valid.url");
      if (pagesPaths.has(url.pathname === "/" ? "" : url.pathname)) {
        return /* @__PURE__ */ jsx2(RemixLink, { ...props, to: href, ref });
      }
    }
    const { prefetch, reloadDocument, replace, preventScrollReset, ...rest } = props;
    return /* @__PURE__ */ jsx2(BaseLink3, { ...rest, ref });
  });
  Component.displayName = BaseLink3.displayName;
  return Component;
};

// src/link.tsx
var Link = wrapLinkComponent(BaseLink);

// src/rich-text-link.tsx
import { RichTextLink as BaseLink2 } from "@webstudio-is/sdk-components-react";
var RichTextLink = wrapLinkComponent(BaseLink2);

// src/form.tsx
import {
  forwardRef as forwardRef3,
  useRef,
  useEffect
} from "react";
import { useFetcher } from "@remix-run/react";
import { formIdFieldName } from "@webstudio-is/form-handlers";
import { getInstanceIdFromComponentProps } from "@webstudio-is/react-sdk";
import { jsx as jsx3, jsxs as jsxs2 } from "react/jsx-runtime";
var useOnFetchEnd = (fetcher, handler) => {
  const latestHandler = useRef(handler);
  latestHandler.current = handler;
  const prevFetcher = useRef(fetcher);
  useEffect(() => {
    if (prevFetcher.current.state !== fetcher.state && fetcher.state === "idle" && fetcher.data !== void 0) {
      latestHandler.current(fetcher.data);
    }
    prevFetcher.current = fetcher;
  }, [fetcher]);
};
var Form = forwardRef3(
  ({ children, action, method, state = "initial", onStateChange, ...rest }, ref) => {
    const fetcher = useFetcher();
    const instanceId = getInstanceIdFromComponentProps(rest);
    useOnFetchEnd(fetcher, (data) => {
      const state2 = data?.success === true ? "success" : "error";
      onStateChange?.(state2);
    });
    return /* @__PURE__ */ jsxs2(fetcher.Form, { ...rest, method: "post", "data-state": state, ref, children: [
      /* @__PURE__ */ jsx3("input", { type: "hidden", name: formIdFieldName, value: instanceId }),
      children
    ] });
  }
);
Form.displayName = "Form";
export {
  Body,
  Form,
  Link,
  RichTextLink
};
